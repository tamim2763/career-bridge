### CareerBridge API Testing

@baseUrl = http://127.0.0.1:3000/api
@token = {{login.response.body.token}}

### Health Check
GET http://127.0.0.1:3000/

###
### ============================================================================
### AUTHENTICATION
### ============================================================================

### Register a new user (simplified - only name, email, password)
POST {{baseUrl}}/register
Content-Type: application/json

{
  "full_name": "Jane Smith",
  "email": "jane.smith@example.com",
  "password": "securepass123"
}

###
### ============================================================================
### OAUTH AUTHENTICATION (Google & GitHub)
### ============================================================================

### Initiate Google Login
# Opens browser for Google OAuth flow
# After authorization, user will be redirected to frontend with token
GET {{baseUrl}}/auth/google

### Initiate GitHub Login
# Opens browser for GitHub OAuth flow
# After authorization, user will be redirected to frontend with token
GET {{baseUrl}}/auth/github

### Note: OAuth Callbacks
# These endpoints are automatically called by the OAuth provider
# GET {{baseUrl}}/auth/google/callback?code=<code>
# GET {{baseUrl}}/auth/github/callback?code=<code>
# 
# After successful authentication, users are redirected to:
# http://localhost:3001/auth/callback?token=<JWT>&new_user=<true|false>
#
# If new_user=true, the frontend should prompt for profile completion

###
### ============================================================================
### STANDARD AUTHENTICATION (Email & Password)
### ============================================================================

### Login
# @name login
POST {{baseUrl}}/login
Content-Type: application/json

{
  "email": "jane.smith@example.com",
  "password": "securepass123"
}

###
### ============================================================================
### PROFILE MANAGEMENT (Protected Routes)
### ============================================================================

### Get Profile (check if profile is completed)
GET {{baseUrl}}/profile
Authorization: Bearer {{token}}

### Complete Profile (onboarding step after registration)
POST {{baseUrl}}/profile/complete
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "education_level": "Bachelor's Degree in Computer Science",
  "experience_level": "junior",
  "preferred_track": "web_development",
  "skills": ["JavaScript", "React", "Node.js", "TypeScript", "PostgreSQL"],
  "projects": ["E-commerce Platform", "Task Management App", "Portfolio Website"],
  "target_roles": ["Full Stack Developer", "Frontend Developer", "React Developer"]
}

### Update Profile (for changes after onboarding)
PUT {{baseUrl}}/profile
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "full_name": "Jane Smith",
  "education_level": "Bachelor's in Computer Science",
  "experience_level": "mid",
  "skills": ["JavaScript", "React", "Node.js", "TypeScript", "PostgreSQL", "Docker"],
  "projects": ["E-commerce Platform", "Task Management App", "Portfolio Website", "Microservices API"],
  "target_roles": ["Full Stack Developer", "Senior Frontend Developer", "Tech Lead"],
  "raw_cv_text": "Experienced developer with 3 years of experience in web development..."
}

### Upload CV/Resume PDF
# Note: The file path should be relative to this .http file or absolute
# Make sure you have a PDF file at the specified location
POST {{baseUrl}}/profile/cv/upload
Authorization: Bearer {{token}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="cv_file"; filename="resume.pdf"
Content-Type: application/pdf

< ../resume.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--
### Verify CV Text Stored in DB (for testing purposes)
##SELECT full_name, raw_cv_text
##FROM users
##WHERE id = '510912e7-7f2f-4fe7-9bfa-0aa629a5d8c7';
###
### ============================================================================
### JOB RECOMMENDATIONS (Protected Routes)
### ============================================================================

### Get Job Recommendations (All)
GET {{baseUrl}}/jobs/recommendations
Authorization: Bearer {{token}}

### Get Job Recommendations (Filtered by experience level)
GET {{baseUrl}}/jobs/recommendations?experience_level=junior&limit=5
Authorization: Bearer {{token}}

### Get Job Recommendations (Filtered by job type)
GET {{baseUrl}}/jobs/recommendations?job_type=full_time&limit=10
Authorization: Bearer {{token}}

###
### ============================================================================
### LEARNING RESOURCES (Protected Routes)
### ============================================================================

### Get Learning Recommendations
GET {{baseUrl}}/learning/recommendations
Authorization: Bearer {{token}}

###
### ============================================================================
### SKILL GAP ANALYSIS (Protected Routes)
### ============================================================================

### Analyze Skill Gap for Target Role
GET {{baseUrl}}/skill-gap/Full Stack Developer
Authorization: Bearer {{token}}

### Analyze Skill Gap for Frontend Developer
GET {{baseUrl}}/skill-gap/Frontend Developer
Authorization: Bearer {{token}}

### Analyze Skill Gap for Data Analyst
GET {{baseUrl}}/skill-gap/Data Analyst
Authorization: Bearer {{token}}

###
### ============================================================================
### APPLICATION TRACKING (Protected Routes)
### ============================================================================

### Create Application
POST {{baseUrl}}/applications
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "job_id": 1,
  "notes": "Applied via company website. Submitted resume and cover letter."
}

### Get My Applications
GET {{baseUrl}}/applications
Authorization: Bearer {{token}}

### Update Application Status
PUT {{baseUrl}}/applications/1
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "status": "interview_scheduled",
  "notes": "Phone interview scheduled for Monday at 10am"
}

### Update Application Status - Second Update
PUT {{baseUrl}}/applications/1
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "status": "offer_received",
  "notes": "Received job offer! Salary: $75,000"
}

###
### ============================================================================
### PROGRESS TRACKING (Protected Routes)
### ============================================================================

### Start Resource
POST {{baseUrl}}/progress/resource/1/start
Authorization: Bearer {{token}}

### Update Progress (25%)
PUT {{baseUrl}}/progress/resource/1
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "completion_percentage": 25
}

### Update Progress (50%)
PUT {{baseUrl}}/progress/resource/1
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "completion_percentage": 50
}

### Update Progress (100% - Completed)
PUT {{baseUrl}}/progress/resource/1
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "completion_percentage": 100
}

### Get My Progress
GET {{baseUrl}}/progress
Authorization: Bearer {{token}}

###
### ============================================================================
### TEST DIFFERENT USER FLOWS
### ============================================================================

### Register Second User (Data Track)
POST {{baseUrl}}/register
Content-Type: application/json

{
  "full_name": "John Data",
  "email": "john.data@example.com",
  "password": "datapass123"
}

### Login Second User
# @name login2
POST {{baseUrl}}/login
Content-Type: application/json

{
  "email": "john.data@example.com",
  "password": "datapass123"
}

### Complete Profile - Second User
POST {{baseUrl}}/profile/complete
Authorization: Bearer {{login2.response.body.token}}
Content-Type: application/json

{
  "education_level": "Master's in Data Science",
  "experience_level": "mid",
  "preferred_track": "data",
  "skills": ["Python", "SQL", "Pandas", "Machine Learning"],
  "target_roles": ["Data Analyst", "Data Scientist"]
}

### Register Third User (Design Track)
POST {{baseUrl}}/register
Content-Type: application/json

{
  "full_name": "Sarah Designer",
  "email": "sarah.design@example.com",
  "password": "designpass123"
}

### Register Fourth User (Marketing Track)
POST {{baseUrl}}/register
Content-Type: application/json

{
  "full_name": "Mike Marketing",
  "email": "mike.marketing@example.com",
  "password": "marketpass123"
}
